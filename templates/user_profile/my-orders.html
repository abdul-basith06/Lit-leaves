{% extends 'partials/base2.html' %}
{% block content %}
<div class="container">
    <h2>My Orders</h2>
    {% if orders %}
     {% for order in orders %}
        <div class="card mb-3" style="margin-bottom: 20px;">
            <div class="card-header">
                <div class="d-flex justify-content-between">
                    <div>
                        <p style="font-size: 16px;">Ordered on</p>
                        <p style="font-size: 18px;">{{ order.date_ordered }}</p>
                    </div>
                    <div>
                        <p style="font-size: 16px;">Total</p>
                        <p style="font-size: 18px;">${{ order.get_cart_total }}</p>
                    </div>
                    <div>
                        <p style="font-size: 16px;">Delivery to</p>
                        <p style="font-size: 18px;">{{ order.shipping_address }}</p>
                    </div>              
                </div>
            </div>
            <hr class="m-0 mb-1">
            <div class="card-body row col-12 d-flex mb-0" style="margin-bottom: 20px;">
                {% for order_item in order.orderitem_set.all %}
                    <div class="col-4">
                        <img src="{{ order_item.product.productimage_set.first.image.url }}" style="max-width: 100%;" alt="{{ order.product.name }}">
                    </div>
                    <div class="col-8">
                        <h5 class="card-title">{{ order_item.product.name }}</h5>
                        <p>{{ order_item.variation.language.name }}</p>
                        <p><b>{{ order_item.product.author }}</b></p>
                        
                        <p class="card-text">
                            <p>Quantity: <b>{{ order_item.quantity }}</b></p>
                            <i class="fa-solid fa-file-invoice-dollar"></i> {{ order.payment_method }}
                        </p>
                        <h5 class="card-title mb-2">â‚¹ {{ order_item.get_total }} </h5>
                        <div class="card-footer" style="background: #F3F3F9; padding: 15px; display: flex; justify-content: space-between; align-items: center; width: 100%;">
                         
                            {# "Arriving on" Section #}
                            <div style="flex-grow: 1;">
                                <p style="font-size: 18px; font-weight: bold; margin-top: 10px;">
                                    Arriving on: <br>{{ order.expected_delivery_date|date:"D, d F" }}
                                </p>
                            </div>
                        
                            {# "Delivery Status" Section #}
                            <div style="flex-grow: 1;">
                                <p style="font-size: 16px; margin-top: 10px;">
                                    Delivery Status: <br>{{ order_item.get_delivery_status_display }}
                                </p>
                            </div>
                        
                            {# "Cancel Order" Button #}
                            <div style="flex-grow: 1; text-align: right;">
                                <button type="button" class="btn btn-danger" style="margin-top: 10px;">
                                    Cancel Order
                                </button>
                            </div>
                            
                        </div>
                        <br>
                        <br>
                        <br>
                       <!-- {# Progress Bar Section #}
<div>
    <div class="progress" style="height: 20px;">
        <div class="progress-bar bg-success" role="progressbar" style="width: 20%;" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">Order Placed</div>
        <div class="progress-bar bg-success" role="progressbar" style="width: 20%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100">Dispatched</div>
        <div class="progress-bar bg-success" role="progressbar" style="width: 20%;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">Shipped</div>
        <div class="progress-bar bg-success" role="progressbar" style="width: 20%;" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100">Out for Delivery</div>
        <div class="progress-bar bg-success" role="progressbar" style="width: 20%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">Delivered</div>
    </div>
    <div class="progress">
        <div class="progress-bar bg-primary" role="progressbar" style="width: {% if order_item.delivery_status == 'PL' %}20{% else %}0{% endif %};" aria-valuenow="{% if order_item.delivery_status == 'PL' %}20{% else %}0{% endif %}" aria-valuemin="0" aria-valuemax="100"></div>
        <div class="progress-bar bg-primary" role="progressbar" style="width: {% if order_item.delivery_status == 'DS' %}20{% else %}0{% endif %};" aria-valuenow="{% if order_item.delivery_status == 'DS' %}40{% else %}0{% endif %}" aria-valuemin="0" aria-valuemax="100"></div>
        <div class="progress-bar bg-primary" role="progressbar" style="width: {% if order_item.delivery_status == 'SH' %}20{% else %}0{% endif %};" aria-valuenow="{% if order_item.delivery_status == 'SH' %}60{% else %}0{% endif %}" aria-valuemin="0" aria-valuemax="100"></div>
        <div class="progress-bar bg-primary" role="progressbar" style="width: {% if order_item.delivery_status == 'OFD' %}20{% else %}0{% endif %};" aria-valuenow="{% if order_item.delivery_status == 'OFD' %}80{% else %}0{% endif %}" aria-valuemin="0" aria-valuemax="100"></div>
        <div class="progress-bar bg-primary" role="progressbar" style="width: {% if order_item.delivery_status == 'DEL' %}20{% else %}0{% endif %};" aria-valuenow="{% if order_item.delivery_status == 'DEL' %}100{% else %}0{% endif %}" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
</div> -->

                         {# Progress Bar Section #}
                         <!-- <div>
                         <div class="progress" style="height: 1px;">
                            <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                          </div>
                          <div class="progress" style="height: 20px;">
                            <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                          </div>
                        </div> -->
                    </div>
                {% endfor %}
            </div>
           
        </div>
        <br>
         {% endfor %}
          {% else %}
        <h1>No orders found.</h1>
   {% endif %}


  </div>

{% endblock content %}
      